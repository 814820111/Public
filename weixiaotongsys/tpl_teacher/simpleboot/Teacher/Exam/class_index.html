<teachertpl file="header" />
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>信息</title>
	<link href="__ROOT__/statics/simpleboot/css/fileinput_message.css" media="all" rel="stylesheet" type="text/css" />
	<link href="__ROOT__/statics/js/artDialog/skins/default.css" rel="stylesheet" />
	<script type="text/javascript" src="__ROOT__/statics/js/jquery.min.js"></script>


	<script type="text/javascript" src="__ROOT__/statics/js/datetime.js"></script>
	<script src="__ROOT__/statics/js/fileinput.js" type="text/javascript"></script>
	<script src="__ROOT__/statics/js/fileinput_locale_zh.js" type="text/javascript"></script>
	<script src="__ROOT__/statics/js/wind.js"></script>
	<style type="text/css">


		.col-auto {
			overflow: auto;
			_zoom: 1;
			_float: left;
		}
			
		.col-right {
			float: right;
			width: 30%;
			overflow: hidden;
			margin-left: 6px;
		}
			
		.table th,
		.table td {
			vertical-align: middle;
		}
			
		.picList li {
			margin-bottom: 5px;
		}
			
		.touchlei {
			background-color: #eeeeee;
		}
			
		tr .pai,
		tr .pai2 {
			text-align: center;
			color: black;
		}
			
		tr .pai {
			background-color: #e2e2e2;

		}
			
		tr .pai2 {}
			
		.clearfix {
			clear: both;
		}
			
		.name {
			margin-right: 10px;
		}
			
		.qinchu {
			border-radius: 25px;
			background-color: whitesmoke;
			border: ridge;
		}
		select{
			color: black;
		}

		span{
			color: black;
		}
		p{
			color: black;
		}
		.modal.fade.in {
			top: 2%;
		}
		i{
			font-style: normal;
			color: black;
		}

	</style>

</head>

<body>

   
<div class="">
	<ul id="myTab" class=" nav-tabs" style=" margin-top:30px; height:30px; list-style:none;">
		<li>
			<a href="{:U('index')}" style="color:#1f1f1f; text-decoration:none; padding:10px 15px;">考试管理</a>
		</li>
		<li>
		<li class="active">
			<a href="{:U('class_index')}" style="color:#1f1f1f; text-decoration:none; padding:10px 15px;">班级成绩管理</a>
		</li>
	</ul>

	<!-- 模态框（Modal） -->
	<div class="modal fade"  id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header"  style="background: white">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					<h5 class="modal-title" id="myModalLabel" style="color: black; font-weight:bold;">成绩详情</h5>
				</div>
				<div class="modal-body" style="max-height: 400px; overflow-y: auto;">

					<div style=" margin-bottom:10px; margin-left:10px;">
						考试名称：<span class="examname"></span><br>
						考试班级：<span class="classname"></span><br>
						<!--<span class="xiugai">考试科目：</span><br>-->
						考试时间：<span class="date"></span><br>

					</div>
					<div class="table-responsive">
						<table class="table table-hover table-bordered table-list" id="table-hover">

							<!--<thead>-->
							<!--<tr style="background-color:#CCC;">-->
							<!--<th class="pai" style=" border-left: none;border-width: 0.5px;">编号</th>-->
							<!--<th class="pai" style=" border-left: none;border-width: 0.5px;">考试类型</th>-->
							<!--<th class="pai" style=" border-left: none;border-width: 0.5px;">考试名称</th>-->
							<!--<th class="pai" style=" border-left: none;border-width: 0.5px;">考试时间</th>-->
							<!--<th class="pai" style=" border-left: none;border-width: 0.5px;">学期</th>-->
							<!--</tr>-->
							<!--</thead>-->
							<!--<tr>-->
							<!--<td class="pai2" style=""></td>-->
							<!--<td class="pai2" style=""></td>-->
							<!--<td class="pai2" style=""></td>-->
							<!--<td class="pai2" style=""></td>-->
							<!--<td class="pai2" style=""></td>-->
							<!--</tr>-->
						</table>
						<div style="height: 50px;"></div>
					</div>
				</div>

				<!--<div class="modal-footer">-->

					<!--<button type="button" class="btn btn-default gb" data-dismiss="modal" style="background: white; color:black; font-weight:bold;">关闭</button>-->
					<!--<button type="button" id="change" class="btn btn-info ci" style="float: right;font-weight:bold;">更改</button>-->

				<!--</div>-->
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal -->
	</div>

	<!-- 模态框（Moda2） -->
	<!--<div class="modal fade"  id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabe2" aria-hidden="true">-->
		<!--<div class="modal-dialog">-->
			<!--<div class="modal-content">-->
				<!--<div class="modal-header"  style="background: white">-->
					<!--<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>-->
					<!--<h5 class="modal-title" id="myModalLabe2" style="color: black; font-weight:bold;">成绩详情</h5>-->
				<!--</div>-->
				<!--<div class="modal-body" style="max-height: 400px; overflow-y: auto;">-->

					<!--<div style=" margin-bottom:10px; margin-left:10px;">-->
						<!--考试名称：<span class="examname2"></span><br>-->
						<!--考试班级：<span class="classname2"></span><br>-->
						<!--&lt;!&ndash;<span class="xiugai">考试科目：</span><br>&ndash;&gt;-->
						<!--考试时间：<span class="date2"></span><br>-->

					<!--</div>-->
					<!--<div class="table-responsive">-->
						<!--<table class="table table-hover table-bordered table-list" id="table-hover2">-->

						<!--</table>-->
						<!--<div style="height: 50px;"></div>-->
					<!--</div>-->
				<!--</div>-->

				<!--&lt;!&ndash;<div class="modal-footer">&ndash;&gt;-->

				<!--&lt;!&ndash;<button type="button" class="btn btn-default gb" data-dismiss="modal" style="background: white; color:black; font-weight:bold;">关闭</button>&ndash;&gt;-->
				<!--<button type="button" id="change" class="btn btn-info ci" style="float: right;font-weight:bold;">保存</button>-->

				<!--&lt;!&ndash;</div>&ndash;&gt;-->
			<!--</div>-->
			<!--&lt;!&ndash; /.modal-content &ndash;&gt;-->
		<!--</div>-->
		<!--&lt;!&ndash; /.modal &ndash;&gt;-->
	<!--</div>-->
	<div id="myTabContent" class="tab-content" style=" padding-left:30px; padding-right:30px;">
		<div class="tab-pane fade in active" id="home">
			<br/>
			<form class="form-horizontal J_ajaxForm" action="{:U('class_index')}" method="get">
				<div class="search_type cc mb10">
					<div class="mb10">
						<span class="mr20">
							考试名称: <input type="text" name="name" value="{$name}">
							学期：
							<select class="select_2" name="semester">
								<option value='0'>--全部--</option>
								<foreach name="semester" item="vo">
									<!--<if condition="$vo.gradeid eq $search_grade">-->
										<!--<OPTION value="{$vo.gradeid}" selected="selected">{$vo.name}</OPTION>-->
									<!--</if>-->
									<!--<if condition="$vo.id neq $search_grade">-->
										<OPTION value="{$vo.id}" <?php if($semesterid==$vo["id"]) echo("selected");?>>{$vo.semester}</OPTION>
									<!--</if>-->
								</foreach>
							</select> &nbsp;&nbsp;
							考试类型：
							<select class="select_2" name="type">
								<option value=''>--请选择--</option>
								<option value="1" <?php if($type==1) echo("selected");?>>单元测试</option>
								<option value="2" <?php if($type==2) echo("selected");?>>月考</option>
								<option value="3" <?php if($type==3) echo("selected");?>>期中考试</option>
								<option value="4" <?php if($type==4) echo("selected");?>>期末考试</option>
								<option value="5" <?php if($type==5) echo("selected");?>>其他</option>
								<!--<option value='1' <?php if($search_type==1) echo("selected");?>>正规班</option>-->
								<!--<option value='2' <?php if($search_type==2) echo("selected");?>>兴趣班</option>-->
							</select> &nbsp;&nbsp;
							班级名称：
							<select class="select_2" name="classid">
								<option value='0'>--全部--</option>
								<foreach name="class" item="vo">
									<!--<if condition="$vo.gradeid eq $search_grade">-->
									<!--<OPTION value="{$vo.gradeid}" selected="selected">{$vo.name}</OPTION>-->
									<!--</if>-->
									<!--<if condition="$vo.id neq $search_grade">-->
										<OPTION value="{$vo.id}" <?php if($classid==$vo["id"]) echo("selected");?>>{$vo.classname}</OPTION>
									<!--</if>-->
								</foreach>
							</select> &nbsp;&nbsp;
							<input type="submit" style=" border:none; background-color:#26a69a; color:white; border-radius:5px; padding:5px 10px 5px 10px;" value="搜索" />
                      
						</span>
					</div>
				</div>
			</form>
			<form class="J_ajaxForm" action="edit_post" method="get">
				<div class="table-responsive">
					<table class="table table-hover table-bordered table-list">
						<thead>
						<tr style="background-color:#CCC;">
							<th class="pai" style=" border-left: none;border-width: 0.5px;">编号</th>
							<th class="pai" style=" border-left: none;border-width: 0.5px;">考试类型</th>
							<th class="pai" style=" border-left: none;border-width: 0.5px;">考试名称</th>
							<th class="pai" style=" border-left: none;border-width: 0.5px;">考试时间</th>
							<th class="pai" style=" border-left: none;border-width: 0.5px;">学期</th>
							<th class="pai" style=" border-left: none;border-width: 0.5px;">班级</th>
							<th class="pai" style=" border-left: none;border-width: 0.5px;">科目</th>
							<th class="pai" style=" border-left: none;border-width: 0.5px;border-right: none">操作</th>
						</tr>
						</thead>
						<foreach name="exam" item="vo">
							<tr>
								<td class="pai2" style="">{$vo.id}</td>
								<td class="pai2" style="">
									<if condition="$vo.type eq 1 "> 单元测试
										<elseif condition="$vo.type eq 2"/>月考
										<elseif condition="$vo.type eq 3"/>期中考试
										<elseif condition="$vo.type eq 4"/>期末考试
										<else /> 其他
									</if>
									<!--{$vo.type}-->
								</td>
								<td class="pai2" style="">{$vo.name}</td>
								<td class="pai2" style="">{$vo.date}</td>
								<td class="pai2" style="">{$vo.semester}</td>
								<td class="pai2" style="">{$vo.classname}</td>
								<!--<td class="pai2" style=""></td>-->
								<td class="pai2 banzhuren_else" style=" color:#00c1dd; cursor:pointer;"><a class="btn btn-success showkey" id={$vo.classid},{$vo.examid},{$vo.id}><span style="color:white;" class={$vo.id}>查看</span></a></td>
								<td class="pai2" style="">
									<a href="{:U('class_delete',array('id'=>$vo['id'],'classid'=>$vo['classid'],'examid'=>$vo['examid']))}" class="J_ajax_del" style=" color:#00c1dd;">
										 删除
									</a>
									<a href="{:U('class_comment',array('classid'=>$vo['classid'],'examid'=>$vo['examid']))}" class="J_ajax_del" style=" color:#00c1dd;">
										发送成绩
									</a>
									<!--<a href="{:U('edit',array('id'=>$vo['id'],'classid'=>$vo['classid']))}" class="J_ajax_del" style=" color:#00c1dd;">-->
										<!--修改-->
									<!--</a>-->
									<!--<a href="{:U('score_update',array('name'=>$vo['name'],'classid'=>$vo['classid'],'examid'=>$vo['examid'],'classname'=>$vo['classname'],'date'=>$vo['date']))}" class="J_ajax_del"  style=" color:#00c1dd;">-->
										<!--编辑成绩-->
									<!--</a>-->
									<!--<button class="btn2" data-toggle="modal" value="{$vo.name},{$vo.classname},{$vo.date},{$vo.examid},{$vo.classid}" data-target="#myModal2" style="font-size: 14px;vertical-align: 1px;background-color: transparent;color: #00c1dd;">-->
										<!--编辑成绩-->
									<!--</button>-->

									<button class="btn" data-toggle="modal" value="{$vo.name},{$vo.classname},{$vo.date},{$vo.examid},{$vo.classid}" data-target="#myModal" style="font-size: 14px;vertical-align: 1px;background-color: transparent;color: #00c1dd;">
										成绩详情
									</button>
									<!--<a href="" class="J_ajax_del" style=" color:#00c1dd;">-->
										<!--成绩导入-->
									<!--</a>-->
								</td>
							</tr>
						</foreach>
					</table>

					<div class="pagination">{$Page}</div>
					<div style="height: 50px;"></div>
				</div>
			</form>
		</div>

	</div>
	<div class="tab-pane fade" id="ios">
	</div>
	<!--班级ID赋值的输入框-->
	<input type="hidden" class="classid" />
</div>
<script type="text/javascript" src="__ROOT__/statics/js/datetime.js"></script>
<script src="__ROOT__/statics/js/common.js"></script>

<script>
    //查看ID
    $(".showkey").click(function(){
        var id = $(this).attr("id");
		//alert(id);
		var arr = id.split(',');
		//console.log(arr);
		classid = arr[0];
		examid = arr[1];
		zid = arr[2];
        $.ajax({
            type: "post",
            // async: false,
            url: "{:U('subjectinfo')}",
            dataType:'json',
            data: {
                'examid': examid,
                'classid': classid
            },
            success: function(res) {
                // res = eval(res);
                console.log(res);
                var subject = "";
                //var z = 0;
                for (var i = 0; i < res.length; i++) {
                    subject += res[i].subject+"丶"
				}
                var tid = "."+zid;
                $(tid).text(subject);

            },
            error: function() {
                alert('系统错误,请稍后重试');
            }
        });
    });
</script>
<script>
    $('.btn').click(function(){
        id = $(this).val();
        console.log(id);
        var arr = id.split(',');
        examname= arr[0]; //考试名称
        classname = arr[1];//班级名称
        date= arr[2];//考试时间
        $(".examname").text(examname);
        $(".classname").text(classname);
        $(".date").text(date);

        examid= arr[3];//考试ID
        classid= arr[4];//班级ID
        $.ajax({
            type: "post",
            url: "{:U('score_details')}",
            dataType: 'json',
            data: {
                examid:examid,
                classid:classid
            },
            success: function(res){
                console.log(res);
                if(res.status.length>0){
                    var html =  " ";
                    html+="<thead>";
                    html+='<tr style="background-color:#CCC;">';
                    html+='<th class="pai" style=" border-left: none;border-width: 0.5px;">编号</th>';
                    html+='<th class="pai" style=" border-left: none;border-width: 0.5px;">姓名</th>';
                    for (var i = 0; i < res.status.length; i++) {
                        html+='<th class="pai" style=" border-left: none;border-width: 0.5px;">'+ res.status[i].subject+'</th>';

                    }
                    html+='<th class="pai" style=" border-left: none;border-width: 0.5px;">评语</th>';
                    html+=" </tr> </thead>";
                    //alert(html);

//                <table class="table table-hover table-bordered table-list">
//                    <thead>
//                    <tr style="background-color:#CCC;">
//                    <th class="pai" style=" border-left: none;border-width: 0.5px;">编号</th>
//                    <th class="pai" style=" border-left: none;border-width: 0.5px;">考试类型</th>
//                    <th class="pai" style=" border-left: none;border-width: 0.5px;">考试名称</th>
//                    <th class="pai" style=" border-left: none;border-width: 0.5px;">考试时间</th>
//                    <th class="pai" style=" border-left: none;border-width: 0.5px;">学期</th>
//                    </tr>
//                    </thead>
//                    <tr>
//                    <td class="pai2" style=""></td>
//                    <td class="pai2" style=""></td>
//                    <td class="pai2" style=""></td>
//                    <td class="pai2" style=""></td>
//                    <td class="pai2" style=""></td>
//                    </tr>
//                    </table>
					if(res.data.length>0){
                        for (var j = 0; j < res.data.length;j++) {
                            html+='<tr>';
                            for (var k= 0; k < res.data[j].length;k++) {
                                html+='<td class="pai2" style="">'+res.data[j][k]+'</td>'
                            }
                            html+='</tr>';
                        }
					}else{
                        html+='<tr>';
                        html+="<td>";
                        html+="暂无数据";
                        html+="</td>";
                        html+='</tr>';
					}



                    $("#table-hover").html(html);
				}
//                for (var j = 0; j < res.length; j++) {
//                    console.log(j);
//                }
//            alert("aaa");

            },
            error: function() {
                //alert('系统错误,请稍后重试');
            }
        });


    })

</script>
<script>
//    $('.btn2').click(function(){
//        id = $(this).val();
//        var arr = id.split(',');
//        examname= arr[0]; //考试名称
//        classname = arr[1];//班级名称
//        date= arr[2];//考试时间
//        $(".examname2").text(examname);
//        $(".classname2").text(classname);
//        $(".date2").text(date);
//
//        examid= arr[3];//考试ID
//        classid= arr[4];//班级ID
//        $.ajax({
//            type: "post",
//            url: "{:U('score_details')}",
//            dataType: 'json',
//            data: {
//                examid:examid,
//                classid:classid
//            },
//            success: function(res){
//                //console.log(res);
//                if(res.status.length>0){
//                    var html =  " ";
//                    html+="<thead>";
//                    html+='<tr style="background-color:#CCC;">';
//                    html+='<th class="pai" style=" border-left: none;border-width: 0.5px;">编号</th>';
//                    html+='<th class="pai" style=" border-left: none;border-width: 0.5px;">姓名</th>';
//                    for (var i = 0; i < res.status.length; i++) {
//                        html+='<th class="pai" style=" border-left: none;border-width: 0.5px;">'+ res.status[i].subject+'</th>';
//
//                    }
//                    html+='<th class="pai" style=" border-left: none;border-width: 0.5px;">评语</th>';
//                    html+=" </tr> </thead>";
//                    //alert(html);
//
////                <table class="table table-hover table-bordered table-list">
////                    <thead>
////                    <tr style="background-color:#CCC;">
////                    <th class="pai" style=" border-left: none;border-width: 0.5px;">编号</th>
////                    <th class="pai" style=" border-left: none;border-width: 0.5px;">考试类型</th>
////                    <th class="pai" style=" border-left: none;border-width: 0.5px;">考试名称</th>
////                    <th class="pai" style=" border-left: none;border-width: 0.5px;">考试时间</th>
////                    <th class="pai" style=" border-left: none;border-width: 0.5px;">学期</th>
////                    </tr>
////                    </thead>
////                    <tr>
////                    <td class="pai2" style=""></td>
////                    <td class="pai2" style=""></td>
////                    <td class="pai2" style=""></td>
////                    <td class="pai2" style=""></td>
////                    <td class="pai2" style=""></td>
////                    </tr>
////                    </table>
//                    if(res.data.length>0){
//                        for (var j = 0; j < res.data.length;j++) {
//                            html+='<tr>';
//                            for (var k= 0; k < res.data[j].length;k++) {
//                                html+='<td class="pai2" style="">'+res.data[j][k]+'</td>'
//                            }
//                            html+='</tr>';
//                        }
//                    }else{
//                        html+='<tr>';
//                        html+="<td>";
//                        html+="暂无数据";
//                        html+="</td>";
//                        html+='</tr>';
//                    }
//
//
//
//                    $("#table-hover2").html(html);
//                }
////                for (var j = 0; j < res.length; j++) {
////                    console.log(j);
////                }
////            alert("aaa");
//
//            },
//            error: function() {
//                //alert('系统错误,请稍后重试');
//            }
//        });
//
//
//    })
</script>
</body>

</html>