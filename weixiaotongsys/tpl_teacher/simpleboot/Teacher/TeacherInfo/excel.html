<teachertpl file="header" />
<html>

	<head>
		<style>

		</style>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>信息1</title>

		<link href="__ROOT__/statics/simpleboot/css/fileinput_message.css" media="all" rel="stylesheet" type="text/css" />
		<script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.js"></script>
		<link href="__ROOT__/statics/js/artDialog/skins/default.css" rel="stylesheet" />
		<script type="text/javascript" src="__ROOT__/statics/js/jquery.min.js"></script>

		<script type="text/javascript" src="__ROOT__/statics/js/datetime.js"></script>
		<script src="__ROOT__/statics/js/fileinput.js" type="text/javascript"></script>
		<script src="__ROOT__/statics/js/fileinput_locale_zh.js" type="text/javascript"></script>
		<script src="__ROOT__/statics/js/layer/layer.js" type="text/javascript"></script>
		<script src="__ROOT__/statics/js/jquery.js"></script>
		<script src="__ROOT__/statics/js/wind.js"></script>
		<style type="text/css">
			.col-auto {
				overflow: auto;
				_zoom: 1;
				_float: left;
			}
			
			.col-right {
				float: right;
				width: 30%;
				overflow: hidden;
				margin-left: 6px;
			}
			
			.table th,
			.table td {
				vertical-align: middle;
				
			}
			
			.picList li {
				margin-bottom: 5px;
			}
			tr .pai,
			tr .pai2 {
				text-align: center;
			}
			
			tr .pai {
				background-color: #e2e2e2;
			}			
			
			.clearfix {
				clear: both;
			}
			
			.name {
				margin-right: 10px;
			}
			
			.dbzr {
				background-color: #61c881;
				color: white;
				text-align: center;
				padding: 0px 15px;
				float: left;
				border-radius: 8px;
			}
			
			.sic {
				width: 15px;
				margin-left: 5px;
				margin-top: -15px;
				cursor: pointer;
			}
			
			.dailei {
				border: 1px solid #dddddd;
				border-bottom: none;
				font-weight: bold;
			}
			
			.banji {
				float: left;
				width: 20%;
				margin-bottom: 10px;
			}
			
			.banji input {
				margin-top: -2px;
				margin-right: 5px;
			}
			
			.subject {
				float: left;
				color: #03a9f4;
				margin-right: 15px;
				cursor: pointer;
				padding: 0 10px;
			}
			
			.peizhi {
				color: #03a9f4;
			}
			
			.kecheng {
				color: #03a9f4;
				float: left;
				display: none;
				border: 1px solid #03a9f4;
				padding-left: 3px;
				padding-right: 3px;
				cursor: pointer;
			}
			
			.subinput {
				display: none;
			}
			
			.newbox div {
				float: left;
				width: 20%;
				margin-bottom: 10px;
			}
			
			.newbox div input {
				margin-top: -2px;
				margin-right: 5px;
			}
			
			.del {
				width: 14px;
				margin-left: 5px;
				margin-top: -2px;
			}
			
			.add_box {
				border: 1px solid #DDDDDD;
				background-color: #f5f5f5;
				text-align: center;
				width: 551px;
				border-top: none;
				padding: 5px;
			}
			
			.class_box {
				border: 1px solid #DDDDDD;
				background-color: #f5f5f5;
				text-align: center;
				line-height: 35px;
				width: 150px;
				border-top: none;
				border-right: none;
			}
			
			.add_ke {
				float: left;
				margin-right: 10px;
				margin-bottom: 5px;
			}
			
			.sub_lei {
				border: 1px solid #03a9f4;
				background-color: #e3f1fa;
			}
			
			.sou {
				display: none
			}
			
			.del {
				width: 10px;
				display: none;
			}
			
			.del_lei {
				display: block;
				float: right;
				margin-top: 5px;
			}
			
			.zongbox {
				margin-top: 15px;
			}
			/*	.class_div{border:1px solid red;}*/
		</style>

	</head>

	<body>
		<div class="">
			<ul id="myTab" class=" nav-tabs" style=" margin-top:30px; height:30px; list-style:none;">
				<li >
					<a href="{:U('index')}" style="color:#1f1f1f; text-decoration:none; padding:10px 15px;">教师管理</a>
				</li>
				<li>
					<a href="{:U('add')}" style="color:#1f1f1f; text-decoration:none; padding:10px 15px;" class="touch">新增教师</a>
				</li>
				<li class="active">
					<a href="" style="color:#1f1f1f; text-decoration:none; padding:10px 15px;" class="touch">导入状态查询</a>
				</li>
			</ul>
			<!--卡号start-->

			<!--卡号end-->
			<!--代班代课start-->
			<!-- 模态框（Modal） -->


			<!--带班代课end-->
			<form action="{:u('excel')}" method="get" >
			<div id="myTabContent" class="tab-content" style=" padding-left:30px; padding-right:30px;">
				<div class="tab-pane fade in active" id="home">
					<br/>
					<!-- <form class="form-horizontal J_ajaxForm" action="{:u('index')}" method="post"> -->
						<div class="search_type cc mb10">
							<div class="mb10">
								<span class="mr20">
                      选择时间:
                      <input type="text" class="J_date" name="begin" placeholder="-选择时间-" >至

                      <input type="text" class="J_date" name="end" placeholder="-选择时间-" >

                      <input type="submit" style=" border:none; background-color:#26a69a; color:white; border-radius:5px; padding:5px 10px 5px 10px; margin-bottom: 10px;" value="查询" />
                      </form>
                     



                     <form class="J_ajaxForm" action="{:u('delpl')}" method="post" style="display: inherit;">

						 <button type="button"   style="    position: relative;
     border:none; background-color:#26a69a; color:white; border-radius:5px; padding:5px 10px 5px 10px; cursor: pointer;     margin-bottom: 10px;" class="remove" >删除</button>

                  </span>
							</div>
						</div>
				
					
					
						<div class="table-responsive">
							<table class="table table-hover table-bordered table-list">
								<thead>
									<tr style="background-color:#CCC;">
										<th class="pai" ><input    type="checkbox" name="" id="checkall"  onclick="checkfk()" size="10">全选</th>
										<th class="pai">文件名称</th>
										<th class="pai">上传时间</th>
										<th class="pai">导入状态</th>
										<th class="pai">查看信息</th>
									</tr>
								</thead>
								<foreach name="excel" item="vo">
								
									<tr class="" >
									   <td style="text-align: center;"><input type="checkbox" name="fkcheck[]"  value="{$vo.id}"></td>
									   <td style="text-align: center;">{$vo.filename}</td>
									   <td style="text-align: center;">{$vo.time|date="Y-m-d H:i:s",###}</td>
									   <td style="text-align: center;">
                                       <if condition="$vo['status'] eq 0">
									     已导入
                                        <elseif condition="$vo['status'] eq 1" />
                                         待处理
									   </if>
									   </td>
									   <td  class="show_re"  data-target="#myModal3"   data-toggle="modal"  data-id="{$vo.id}"  style="text-align: center; color:#00c1dd; cursor: pointer;">查看处理结果</td>
									</tr>
                               </foreach>


					                  


                                        <div class="modal fade" id="myModal3" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
										  <div class="modal-dialog">
										    <div class="modal-content">
										      <div class="modal-header" style="background: white">
										        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
										        <h5 class="modal-title" id="myModalLabel" style="color: black; font-weight:bold;">查看处理结果</h5>
										        <hr/>
										      </div>
										      <div class="modal-body2">
					                           
    
										         <p class="text-center">
										        <input type="hidden" class="techar_id" ><br>
                                                   文件名: <span class="filename">是是是</span><br>
										           导入时间	: <span class="le_time">是是是</span><br>
										           处理结果 : <span class="result">是是是</span></p>
										      </div>
										      <div class="modal-footer">
										        <button type="button" class="btn btn-default" data-dismiss="modal" style="background: white; color:black; font-weight:bold;">关闭</button>
										       
										      </div>
										   
										    </div>
										  </div>
										</div>

							</table>
							<div class="pagination">{$Page}</div>

						</div>
					</form>

					<div style="height: 50px;"></div>
				</div>

			</div>
			<input type="hidden" class="Loocliassid" />
            <!--存放班级改变时候的班级ID-->
			<input type="hidden" class="cliaasid" />
			<div class="tab-pane fade" id="ios">
			</div>

		</div>
		<script type="text/javascript" src="__ROOT__/statics/js/datetime.js"></script>
		<script src="__ROOT__/statics/js/common.js"></script>

		<script type="text/javascript">
   


       </script>

       </script>


      

       <script>


  


       	
function checkfk(){
        var allcheck=document.getElementById("checkall");  //获取 全选check 的id
        var othercheck=document.getElementsByName("fkcheck[]"); //获取数组名称为fkcheck的 复选框
for(var i=0;i<othercheck.length;i++){ 
if(allcheck.checked){ othercheck[i].checked=true;
  }else{ othercheck[i].checked=false;
    } 
  } 
}  //循环遍历 复选框 ，当点击全选时，其它被选中，否则取消选中




       //触发删除按钮

       $('.remove').click(function(){

           if(confirm("确定要删除吗？")==true) {
               var id = document.getElementsByName('fkcheck[]');
               console.log(id.length);
               var ids = new Array();
               for (var i = 0; i < id.length; i++) {
                   if (id[i].checked) {
                       ids.push(id[i].value);

                   }
               }
               if(ids.length < 1)
               {
                   alert("请选择要删除的信息!");
                   return false;
               }




               $.ajax({
                   type:'post',
                   url: "{:U('Teacher/TeacherInfo/delpl')}",
                   dataType:'json',
                   data: {
                       'ids':ids,
                   },
                   success:function(data){
                       if(data.status){
                           alert("成功删除"+data.msg+"条");
                           $("input[name='fkcheck[]']").each(function(){
                               if ($(this).attr('checked')) {
                                   $(this).parent().parent().remove();
                               }
                           })


                       }else{
                           alert('删除失败');
                       }
                   },
                   //请求失败
                   error:function(){
                       alert('请求失败')
                   }
               })

           }

       })



  // function delAjax(check_val)
  // {
  // 	  $.ajax({
		//             type:'get',
		//             url: "{:U('Teacher/TeacherInfo/showre')}",
		//             dataType:'json',
		//             data: {
		// 				'check_val': check_val,
		// 			},
		//             success:function(data){
		//                  // console.log(data.msg);
		//                  // console.log(data.msg.filename);
		//                  // console.log(obj);
                      
		//                 if(data.status){


		//                 	alert('删除成功');
		//                   // obj.text(data.msg.filename);
		//                   // time.text(data.msg.time);
		//                   // result.text(data.msg.pro);

		//                 }else{
		//                     alert('查看失败');
		//                 }
		//             },
		//             //请求失败
		//             error:function(){
		//                alert('请求失败')
		//             }
		//         })
  // }



   
    //查看处理结果

 	 $('.show_re').click(function(){
      	 var show_id = $(this).attr('data-id');
			   console.log(show_id); 
         var obj = $('.filename');
         var time = $('.le_time')
         var result = $('.result');
        // console.log(time);
          console.log(obj);
          console.log(time);
          console.log(result);


			    showreAjax(show_id,obj,time,result);
      })
   

   function showreAjax(show_id,obj,time,result)
   {
    
           $.ajax({
		            type:'get',
		            url: "{:U('Teacher/TeacherInfo/showre')}",
		            dataType:'json',
		            data: {
						'excelid': show_id,
					},
		            success:function(data){
		                  console.log(data.msg);
		                 // console.log(data.msg.filename);
		                 // console.log(obj);
                      
		                if(data.status){
		                  obj.text(data.msg.filename);
		                  time.text(data.msg.time);
		                  result.text(data.msg.pro);

		                }else{
		                    alert('查看失败');
		                }
		            },
		            //请求失败
		            error:function(){
		               alert('请求失败')
		            }
		        })


   }



       </script>

	</body>

</html>