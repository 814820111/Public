<admintpl file="header" />
<body class="J_scroll_fixed">
	<div class="wrap jj">
		<ul class="nav nav-tabs">
			<li><a href="{:U('menu_index')}">菜单列表</a></li>
			<li class="active"><a href="{:U('custommenu')}">生成自定义菜单</a></li>
		</ul>
		<div class="common-form">
			<form method="post" class="form-horizontal J_ajaxForm" action="{:U('custommenu_post')}">
				<fieldset>
                    <div class="control-group">
                        <label class="control-label">选择公众号:</label>
                        <div class="controls">
                            <select name="manage_id" class="normal_select" id="wx_select">
                                <foreach name="wxmanage" item="v">
                                    <!--<php>$navcid_selected=$navcid==$vo['navcid']?"selected":"";</php>-->
                                    <!--<option value="{$vo.navcid}" {$navcid_selected}>{$vo.name}</option>-->
                                    <option value="{$v.id}">{$v.wx_name}</option>
                                </foreach>
                                {$nav_trees}
                            </select>
                        </div>

                    </div>
					<div class="control-group">
						<label class="control-label">父菜单:</label>
						<div class="controls">
							<select name="parentid" class="normal_select" id="menu_slect">
                                <option value="0" selected="selected">作为根菜单</option>
                                {$nav_trees}
							</select>
                            <font style="color:#FF3300; font-size:12px">微信端最多创建3 个一级菜单，每个一级菜单下最多可以创建 5 个二级菜单，菜单最多支持两层。</font>
						</div>

					</div>

					<div class="control-group">
						<label class="control-label">菜单名称:</label>
						<div class="controls">
							<input type="text" class="input" name="name" value="">

						</div>
					</div>
					<div class="control-group">
						<label class="control-label">显示排序:</label>
						<div class="controls">
							<input type="text" class="input" name="orderby" value="">
                            <font style="color:#FF3300; font-size:12px">横排一级菜单排序小到大 左到右 竖排二级菜单 小到大 对应着上到下</font>
						</div>
					</div>

					<div class="control-group">
						<label class="control-label">菜单类型:</label>
						<div class="controls">
							<select name="typeid" id="navcid_select" class="normal_select" onChange="selectTr($(this).val())">
                                <!--<option value="1" >关键词回复菜单</option>-->

                                <option value="6">网页授权登录</option>

                                <!--<option value="7">功能模块</option>-->

                                <option value="2" selected="selected">url链接菜单</option>

                                <option value="3">微信扩展菜单</option>

                                <!--<option value="4">一键拨号菜单</option>-->

                                <!--<option value="5">位置地图</option>-->
							</select>
						</div>
					</div>
                    <!--<div class="control-group" id="select_1" style="display:none">-->
                        <!--<label class="control-label">要触发的关键字:</label>-->
                        <!--<div class="controls">-->
                            <!--<input type="text" class="input" name="keyword" value="">-->
                        <!--</div>-->
                    <!--</div>-->
                    <div class="control-group" id="select_2" >
                        <label class="control-label">链接 URL:</label>
                        <div class="controls">
                            <input type="text" class="input" name="url" value="">
                        </div>
                    </div>
                    <div class="control-group" id="select_3" style="display:none">
                        <label class="control-label">菜单事件:</label>
                        <div class="controls">
                            <select name="event" id="event" class="normal_select">
                                <option value="scancode_waitmsg">扫码带提示</option>

                                <option value="scancode_push">扫码推事件</option>

                                <option value="pic_sysphoto">系统拍照发图</option>

                                <option value="pic_photo_or_album">拍照或者相册发图</option>

                                <option value="pic_weixin">微信相册发图</option>

                                <option value="location_select">发送位置</option>
                            </select>
                        </div>
                    </div>
                    <!--<div class="control-group" id="select_4" style="display:none">-->
                        <!--<label class="control-label">联系电话:</label>-->
                        <!--<div class="controls">-->
                            <!--<input type="text" class="input" name="phone" value="">-->
                        <!--</div>-->
                    <!--</div>-->
                    <!--<div class="control-group" id="select_5" style="display:none">-->
                        <!--<label class="control-label">地图坐标:</label>-->
                        <!--<div class="controls">-->
                            <!--<input type="text" class="input" name="location" value="">-->
                        <!--</div>-->
                    <!--</div>-->
                    <div class="control-group" id="select_6" style="display:none">
                        <label class="control-label">登录后跳转的url:</label>
                        <div class="controls">
                            <input type="text" class="input" name="redirect_url" value="">
                        </div>
                    </div>

                    <!--<div class="control-group" id="select_7" style="display:none">-->
                        <!--<label class="control-label">功能模块:</label>-->
                        <!--<div class="controls">-->
                            <!--<select name="jj" id="t" class="normal_select">-->
                                <!--&lt;!&ndash;<foreach name="navcats" item="vo">&ndash;&gt;-->
                                    <!--&lt;!&ndash;<php>$navcid_selected=$navcid==$vo['navcid']?"selected":"";</php>&ndash;&gt;-->
                                    <!--&lt;!&ndash;<option value="{$vo.navcid}" {$navcid_selected}>{$vo.name}</option>&ndash;&gt;-->
                                <!--&lt;!&ndash;</foreach>&ndash;&gt;-->
                            <!--</select>-->
                        <!--</div>-->
                    <!--</div>-->
				</fieldset>
				<div class="form-actions">
					<button type="submit"
						class="btn btn-primary btn_submit J_ajax_submit_btn">添加</button>
					<!--<a class="btn" href="__URL__">返回</a>-->
				</div>
			</form>
		</div>
	</div>
    一级菜单(家校互动) 二级菜单(家庭作业,信息通知,考试成绩,考勤管理)<br>
    一级菜单(班级空间) 二级菜单(班级活动,班级主页)<br>
    一级菜单(个人中心) 二级菜单(账号绑定,在线请假,我的学校,通讯录,我的资料)<br>
单一公众号:schoolid:学校ID appid:公众号ID<br>
    班级主页:例如: http://mp.zhixiaoyuan.net/index.php/weixin/SingleAccredit/accept?appid=16&schoolid=3<br>
    账号绑定:例如: http://mp.zhixiaoyuan.net/index.php/weixin/SingleBinding/accept?appid=16&schoolid=3<br>
    我的学校:例如: http://mp.zhixiaoyuan.net/index.php/weixin/Schoolweb/index?schoolid=3<br>
    家庭作业:例如: http://mp.zhixiaoyuan.net/index.php/weixin/SingleMenu/accept?action=Homework&type=1&schoolid=3&appid=16<br>
    信息通知:例如: http://mp.zhixiaoyuan.net/index.php/weixin/SingleMenu/accept?action=Notice&type=1&schoolid=3&appid=16<br>
    考试成绩:例如: http://mp.zhixiaoyuan.net/index.php/weixin/SingleMenu/accept?action=Exam&type=1&schoolid=3&appid=16<br>
    考勤管理:例如: http://mp.zhixiaoyuan.net/index.php/weixin/SingleMenu/accept?action=SignIn&type=1&schoolid=3&appid=16<br>
    班级活动:例如: http://mp.zhixiaoyuan.net/index.php/weixin/SingleMenu/accept?action=Activity&type=1&schoolid=3&appid=16<br>
    家庭作业:例如: http://mp.zhixiaoyuan.net/index.php/weixin/SingleMenu/accept?action=Homework&type=1&schoolid=3&appid=16<br>
    在线请假:例如: http://mp.zhixiaoyuan.net/index.php/weixin/SingleMenu/accept?action=Leave&type=1&schoolid=3&appid=16<br>
    通讯录:例如: http://mp.zhixiaoyuan.net/index.php/weixin/SingleMenu/accept?action=Mobilephone&type=1&appid=16&schoolid=3<br>
    我的资料:例如: http://mp.zhixiaoyuan.net/index.php/weixin/SingleMenu/accept?action=Usercenter&type=1&schoolid=3&appid=16<br>
 统一公众号: schoolid:学校ID appid:公众号ID <br>
    班级主页:例如: http://mp.zhixiaoyuan.net/index.php/weixin/Accredit/accept?appid=11<br>
    账号绑定:例如: http://mp.zhixiaoyuan.net/index.php/weixin/Binding/accept?appid=11<br>
    我的学校:例如: http://mp.zhixiaoyuan.net/index.php/weixin/Schoolweb/accept?appid=11<br>
    家庭作业:例如: http://mp.zhixiaoyuan.net/index.php/weixin/Menu/accept?type=1&action=Homework&appid=11<br>
    信息通知:例如: http://mp.zhixiaoyuan.net/index.php/weixin/Menu/accept?type=1&action=Notice&appid=11<br>
    考试成绩:例如: http://mp.zhixiaoyuan.net/index.php/weixin/Menu/accept?type=1&action=Exam&appid=11<br>
    考勤管理:例如: http://mp.zhixiaoyuan.net/index.php/weixin/Menu/accept?type=1&action=SignIn&appid=11<br>
    班级活动:例如: http://mp.zhixiaoyuan.net/index.php/weixin/Menu/accept?type=1&action=Activity&appid=11<br>
    家庭作业:例如: http://mp.zhixiaoyuan.net/index.php/weixin/Menu/accept?type=1&action=Homework&appid=11<br>
    在线请假:例如: http://mp.zhixiaoyuan.net/index.php/weixin/Menu/accept?type=1&action=Leave&appid=11<br>
    通讯录:例如: http://mp.zhixiaoyuan.net/index.php/weixin/Menu/accept?appid=11&type=1&action=Mobilephone<br>
    我的资料:例如: http://mp.zhixiaoyuan.net/index.php/weixin/Menu/accept?appid=11&type=1&action=Usercenter<br>


	<script src="__ROOT__/statics/js/common.js"></script>
    <script language="javascript" type="text/javascript">
        function selectTr(id)
        {
            for(var i=1;i<=7;i++)
            {
                $('#select_'+i).hide();
            }
            $('#select_'+id).show();
        }
        $("document").ready(function() {
            var manage_id = $("#wx_select option:selected").val();

            $.ajax({
                type: "post",
                url: "{:U('menu_list')}",
                async: true,
                data: {
                    manage_id: manage_id,

                },
                dataType: 'json',
                success : function(res){
                    var html = "";

                    if(res.length==0){
                        //html+="<option value='"+id+"'>"+name+"</option>"
                       html+='<option value="0" selected="selected">'+'作为根菜单'+'</option>'
                        $("#menu_slect").html(html);
                    }else{
                        html+='<option value="0" selected="selected">'+'作为根菜单'+'</option>'
                        for (var i = 0; i < res.length; i++) {
                            id = res[i].id;
                            name = res[i].name;
//                            if(res[i].menulevel==2){
//                                html+="<option value='"+id+"'>"+"--"+name+"</option>"
//                            }else{
//                                html+="<option value='"+id+"'>"+name+"</option>"
//                            }
                            html+="<option value='"+id+"'>"+name+"</option>"

                        }
                        $("#menu_slect").html(html);
                    }
                },
                error: function(res){

                }
            });
        });

        $("#wx_select").change(function() {

            var manage_id = $("#wx_select option:selected").val();

            $.ajax({
                type: "post",
                url: "{:U('menu_list')}",
                async: true,
                data: {
                    manage_id: manage_id,

                },
                dataType: 'json',
                success : function(res){
                    var html = "";
                    if(res.length==0){
                        //html+="<option value='"+id+"'>"+name+"</option>"
                        html+='<option value="0" selected="selected">'+'作为根菜单'+'</option>'
                        $("#menu_slect").html(html);
                    }else{
                        html+='<option value="0" selected="selected">'+'作为根菜单'+'</option>'
                        for (var i = 0; i < res.length; i++) {
                            id = res[i].id;
                            name = res[i].name;
//                            if(res[i].menulevel==2){
//                                html+="<option value='"+id+"'>"+"--"+name+"</option>"
//                            }else{
//                                html+="<option value='"+id+"'>"+name+"</option>"
//                            }
                            html+="<option value='"+id+"'>"+name+"</option>"

                        }
                        $("#menu_slect").html(html);
                    }
                },
                error: function(res){

                }
            });
        });
    </script>
</body>
</html>